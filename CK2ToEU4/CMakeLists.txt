cmake_minimum_required(VERSION 3.5)
#set(CMAKE_VERBOSE_MAKEFILE on)

project(CK2ToEU4)
#SET(CMAKE_CXX_COMPILER g++-9)
set(CMAKE_BINARY_DIR ${CMAKE_SOURCE_DIR}/Source)
set(PROJECT_SOURCE_DIR ${CMAKE_SOURCE_DIR}/Source)
set(EXECUTABLE_OUTPUT_PATH ${CMAKE_SOURCE_DIR}/Release-Linux)
set(LIBRARY_OUTPUT_PATH ${CMAKE_SOURCE_DIR}/Release-Linux)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++17")

add_compile_options("-lstdc++fs")
add_compile_options("-O2")
add_compile_options("-pthread")
add_link_options(-no-pie)

include_directories("../commonItems")
include_directories("../ZipLib")
include_directories("${PROJECT_SOURCE_DIR}")

add_subdirectory(../ZipLib [binary_dir])

file(GLOB MAIN_SOURCES "${PROJECT_SOURCE_DIR}/*.cpp")
file(GLOB COMMON_COMMON_SOURCES "${PROJECT_SOURCE_DIR}/Common/*.cpp")
file(GLOB CONFIGURATION_SOURCES "${PROJECT_SOURCE_DIR}/Configuration/*.cpp")
file(GLOB CK2WORLD_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/*.cpp")
file(GLOB CK2WORLD_CHARACTERS_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Characters/*.cpp")
file(GLOB CK2WORLD_DYNASTIES_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Dynasties/*.cpp")
file(GLOB CK2WORLD_TITLES_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Titles/*.cpp")
file(GLOB CK2WORLD_PROVINCES_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Provinces/*.cpp")
file(GLOB CK2WORLD_WONDERS_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Wonders/*.cpp")
file(GLOB CK2WORLD_OFFMAPS_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Offmaps/*.cpp")
file(GLOB CK2WORLD_MODS_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Mods/*.cpp")
file(GLOB CK2WORLD_RELATIONS_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Relations/*.cpp")
file(GLOB CK2WORLD_VARS_SOURCES "${PROJECT_SOURCE_DIR}/CK2World/Vars/*.cpp")
file(GLOB MAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/*.cpp")
file(GLOB MAPPER_LOCALIZATIONMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/LocalizationMapper/*.cpp")
file(GLOB MAPPER_COLORSCRAPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/ColorScraper/*.cpp")
file(GLOB MAPPER_IAMHREMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/IAmHreMapper/*.cpp")
file(GLOB MAPPER_CULTUREMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/CultureMapper/*.cpp")
file(GLOB MAPPER_GOVERNMENTSMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/GovernmentsMapper/*.cpp")
file(GLOB MAPPER_REGIONMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/RegionMapper/*.cpp")
file(GLOB MAPPER_RELIGIONMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/ReligionMapper/*.cpp")
file(GLOB MAPPER_PROVINCEMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/ProvinceMapper/*.cpp")
file(GLOB MAPPER_PROVINCETITLEMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/ProvinceTitleMapper/*.cpp")
file(GLOB MAPPER_TITLETAGMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/TitleTagMapper/*.cpp")
file(GLOB MAPPER_VERSIONPARSER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/VersionParser/*.cpp")
file(GLOB MAPPER_RULERPERSONALITIESMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/RulerPersonalitiesMapper/*.cpp")
file(GLOB MAPPER_PERSONALITYSCRAPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/PersonalityScraper/*.cpp")
file(GLOB MAPPER_SHATTEREMPIRESMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/ShatterEmpiresMapper/*.cpp")
file(GLOB MAPPER_PRIMARYTAGMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/PrimaryTagMapper/*.cpp")
file(GLOB MAPPER_DEVWEIGHTSMAPPER_SOURCES "${PROJECT_SOURCE_DIR}/Mappers/DevWeightsMapper/*.cpp")
file(GLOB EU4WORLD_SOURCES "${PROJECT_SOURCE_DIR}/EU4World/*.cpp")
file(GLOB EU4WORLD_COUNTRY_SOURCES "${PROJECT_SOURCE_DIR}/EU4World/Country/*.cpp")
file(GLOB EU4WORLD_DIPLOMACY_SOURCES "${PROJECT_SOURCE_DIR}/EU4World/Diplomacy/*.cpp")
file(GLOB EU4WORLD_PROVINCE_SOURCES "${PROJECT_SOURCE_DIR}/EU4World/Province/*.cpp")
file(GLOB EU4WORLD_OUTPUT_SOURCES "${PROJECT_SOURCE_DIR}/EU4World/Output/*.cpp")
set(COMMON_SOURCES "../commonItems/CommonFunctions.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/newColor.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/GameVersion.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/Date.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/LinuxUtils.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/Log.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/OSCommonLayer.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/Parser.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/ParserHelpers.cpp")
set(COMMON_SOURCES ${COMMON_SOURCES} "../commonItems/StringUtils.cpp")

add_executable(CK2ToEU4 
	${MAIN_SOURCES}
	${COMMON_COMMON_SOURCES}
	${CONFIGURATION_SOURCES}
	${CK2WORLD_SOURCES}
	${CK2WORLD_DYNASTIES_SOURCES}
	${CK2WORLD_TITLES_SOURCES}
	${CK2WORLD_CHARACTERS_SOURCES}
	${CK2WORLD_PROVINCES_SOURCES}
	${CK2WORLD_WONDERS_SOURCES}
	${CK2WORLD_OFFMAPS_SOURCES}
	${CK2WORLD_MODS_SOURCES}
	${CK2WORLD_RELATIONS_SOURCES}
	${CK2WORLD_VARS_SOURCES}
	${MAPPER_SOURCES}
	${MAPPER_COLORSCRAPER_SOURCES}
	${MAPPER_LOCALIZATIONMAPPER_SOURCES}
	${MAPPER_IAMHREMAPPER_SOURCES}
	${MAPPER_CULTUREMAPPER_SOURCES}
	${MAPPER_GOVERNMENTSMAPPER_SOURCES}
	${MAPPER_REGIONMAPPER_SOURCES}
	${MAPPER_RELIGIONMAPPER_SOURCES}
	${MAPPER_PROVINCEMAPPER_SOURCES}
	${MAPPER_PROVINCETITLEMAPPER_SOURCES}
	${MAPPER_TITLETAGMAPPER_SOURCES}
	${MAPPER_VERSIONPARSER_SOURCES}
	${MAPPER_RULERPERSONALITIESMAPPER_SOURCES}
	${MAPPER_PERSONALITYSCRAPER_SOURCES}
	${MAPPER_SHATTEREMPIRESMAPPER_SOURCES}
	${MAPPER_PRIMARYTAGMAPPER_SOURCES}
	${MAPPER_DEVWEIGHTSMAPPER_SOURCES}
	${EU4WORLD_SOURCES}
	${EU4WORLD_PROVINCE_SOURCES}
	${EU4WORLD_COUNTRY_SOURCES}
	${EU4WORLD_DIPLOMACY_SOURCES}
	${EU4WORLD_OUTPUT_SOURCES}
	${COMMON_SOURCES}
)

target_link_libraries(CK2ToEU4 LINK_PUBLIC ZIPLIB stdc++fs)

add_custom_command(TARGET CK2ToEU4 POST_BUILD WORKING_DIRECTORY ${CMAKE_SOURCE_DIR} COMMAND chmod u+x Copy_Files.sh)
add_custom_command(TARGET CK2ToEU4 POST_BUILD WORKING_DIRECTORY ${CMAKE_SOURCE_DIR} COMMAND ./Copy_Files.sh)
